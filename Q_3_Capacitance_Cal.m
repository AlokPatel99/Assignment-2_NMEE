%% --- Capacitance Calculations --- %%

Potential = [0;0;0;0;0;0;23.2568674801173;22.2643057533745;
    19.1106843503746;13.6519290102836;7.01855435376675;0;0;
    14.4222883912879;28.4784773616273;40.5265026047826;46.6896712215120;
    48.4988583816628;77.3592236491626;75.4690180911891;67.8271775336894;
    45.3131894026422;22.1921218710458;0;0;29.0330096687591;62.7549808782839;
    110;110;110;110;66.6737244214342;31.1849359428342;0];
vertex = [1,2,12;2,11,12;2,3,11;3,10,11;3,4,10;4,9,10;4,5,9;5,8,9;5,6,8;
    6,7,8;8,7,17;7,18,17;9,8,16;8,17,16;10,9,15;9,16,15;11,10,14;10,15,14;
    12,11,13;11,14,13;13,14,24;14,23,24;14,15,23;15,22,23;15,16,22;16,21,22;
    16,17,21;17,20,21;17,18,20;18,19,20;20,19,29;19,30,29;21,20,28;20,29,28;
    22,21,27;21,28,27;23,22,26;22,27,26;24,23,25;23,26,25;25,26,34;26,33,34;
    26,27,33;27,32,33;27,28,32;28,31,32];
Sa = [1 -0.5 -0.5;
     -0.5 0.5 0;
     -0.5 0 0.5];
Sb = [0.5 -0.5 0;
     -0.5 1 -0.5;
      0 -0.5 0.5];
E = zeros(46,1);
U = zeros(3,1);
V = 110;
Energy = 0;
eps = 8.85e-12;

for i=1:46
    if mod(i,2)~=0
        S = Sa;
    else
        S = Sb;
    end
    verte = vertex(i,:);
    U(1,1) = Potential(verte(1));
    U(2,1) = Potential(verte(2));
    U(3,1) = Potential(verte(3));
    E(i) = (U'*S*U);
    Energy = Energy + (E(i)/2);
end
Ener = 4*eps*Energy;         
C = (2*Ener)/(V^2);
disp('The capacitance is: ')
disp(C)

%% --- Code Ends --- %%